FROM node:14-alpine
WORKDIR /usr/src/app

RUN apk update
RUN apk --no-cache add tzdata git

ENV TZ=Asia/Taipei
ENV NODE_ENV=production
ENV PUBLIC_URL=/

RUN npm install -g react-app-rewired

COPY . .

RUN npm install -i

RUN npm run build

FROM nginx:alpine
WORKDIR /usr/share/nginx/html

COPY --from=0 /usr/src/app/build/ ./
